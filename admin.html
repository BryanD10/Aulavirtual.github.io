<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Panel Docente | AULA DIGITAL CENTED</title>
<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#060d18;--surface:#0c1a2e;--surface2:#112240;
  --border:rgba(99,179,237,0.15);--accent:#63b3ed;--accent2:#68d391;
  --accent3:#f6ad55;--danger:#fc8181;--text:#e2e8f0;
  --text-dim:#718096;--text-muted:#4a5568;--radius:12px;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{background:var(--bg);font-family:'Nunito',sans-serif;color:var(--text);min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background-image:radial-gradient(circle at 1px 1px,rgba(99,179,237,0.04) 1px,transparent 0);
  background-size:32px 32px}

/* LOGIN */
#login-screen{position:fixed;inset:0;z-index:1000;display:flex;align-items:center;justify-content:center;background:var(--bg)}
.login-box{width:100%;max-width:440px;padding:2.5rem;background:var(--surface);border:1px solid var(--border);border-radius:20px;box-shadow:0 0 60px rgba(99,179,237,0.07)}
.login-logo{text-align:center;margin-bottom:2rem}
.login-logo .badge{display:inline-flex;align-items:center;justify-content:center;width:64px;height:64px;border-radius:16px;margin-bottom:1rem;background:linear-gradient(135deg,var(--accent),var(--accent2));font-family:'Rajdhani',sans-serif;font-size:1.4rem;font-weight:700;color:var(--bg);box-shadow:0 0 30px rgba(99,179,237,0.3)}
.login-logo h1{font-family:'Rajdhani',sans-serif;font-size:1.6rem;font-weight:700}
.login-logo p{color:var(--text-dim);font-size:0.82rem;margin-top:0.3rem}
.field{margin-bottom:1.2rem}
.field label{display:block;font-size:0.78rem;font-weight:800;color:var(--text-dim);letter-spacing:0.08em;text-transform:uppercase;margin-bottom:0.45rem}
.field input{width:100%;background:var(--bg);border:1px solid var(--border);color:var(--text);padding:0.75rem 1rem;border-radius:9px;font-family:'Nunito',sans-serif;font-size:0.92rem;outline:none;transition:border-color 0.2s,box-shadow 0.2s}
.field input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(99,179,237,0.12)}
.field .hint{font-size:0.72rem;color:var(--text-muted);margin-top:0.4rem;line-height:1.5}
.field .hint a{color:var(--accent);text-decoration:none}
.field .hint a:hover{text-decoration:underline}
.btn-login{width:100%;padding:0.85rem;border:none;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));color:var(--bg);font-family:'Nunito',sans-serif;font-size:0.95rem;font-weight:800;cursor:pointer;transition:all 0.25s;margin-top:0.5rem;box-shadow:0 0 20px rgba(99,179,237,0.25)}
.btn-login:hover{transform:translateY(-1px);box-shadow:0 0 35px rgba(99,179,237,0.4)}
.login-error{background:rgba(252,129,129,0.1);border:1px solid rgba(252,129,129,0.3);color:var(--danger);border-radius:8px;padding:0.7rem 1rem;font-size:0.82rem;margin-top:1rem;display:none}
.token-steps{background:rgba(99,179,237,0.06);border:1px solid rgba(99,179,237,0.15);border-radius:10px;padding:1rem;margin-top:0.5rem}
.token-steps p{font-size:0.75rem;color:var(--text-dim);line-height:1.7}
.token-steps b{color:var(--accent)}
.token-steps a{color:var(--accent2);text-decoration:none;font-weight:700}

/* APP */
#app{display:none;position:relative;z-index:1}

/* SIDEBAR */
.sidebar{position:fixed;top:0;left:0;bottom:0;width:240px;background:var(--surface);border-right:1px solid var(--border);display:flex;flex-direction:column;z-index:100}
.sidebar-logo{padding:1.6rem 1.4rem 1.1rem;border-bottom:1px solid var(--border)}
.sidebar-logo .s-badge{display:inline-flex;align-items:center;justify-content:center;width:38px;height:38px;border-radius:9px;background:linear-gradient(135deg,var(--accent),var(--accent2));font-family:'Rajdhani',sans-serif;font-size:0.95rem;font-weight:700;color:var(--bg);box-shadow:0 0 16px rgba(99,179,237,0.3);margin-bottom:0.7rem}
.sidebar-logo h2{font-family:'Rajdhani',sans-serif;font-size:1rem;font-weight:700;line-height:1.2}
.sidebar-logo span{font-size:0.65rem;color:var(--text-dim);letter-spacing:0.12em;text-transform:uppercase}
.sidebar-repo{margin:0.8rem;padding:0.65rem 0.9rem;background:rgba(99,179,237,0.07);border:1px solid rgba(99,179,237,0.2);border-radius:9px}
.sidebar-repo .repo-label{font-size:0.65rem;font-weight:800;letter-spacing:0.1em;color:var(--text-dim);text-transform:uppercase;margin-bottom:0.3rem}
.sidebar-repo .repo-name{font-size:0.8rem;font-weight:700;color:var(--accent);word-break:break-all}
.nav-section{padding:0.5rem 1rem;font-size:0.63rem;font-weight:800;letter-spacing:0.15em;text-transform:uppercase;color:var(--text-muted)}
.nav-item{display:flex;align-items:center;gap:10px;padding:0.6rem 1.1rem;margin:0.1rem 0.5rem;border-radius:9px;cursor:pointer;font-size:0.83rem;font-weight:700;color:var(--text-dim);transition:all 0.18s;border:1px solid transparent}
.nav-item:hover{background:rgba(255,255,255,0.04);color:var(--text)}
.nav-item.active{background:rgba(99,179,237,0.1);color:var(--accent);border-color:rgba(99,179,237,0.2)}
.nav-item .ni{width:20px;text-align:center;font-size:1rem}
.sidebar-footer{margin-top:auto;padding:1rem;border-top:1px solid var(--border)}
.logout-btn{display:flex;align-items:center;gap:8px;width:100%;padding:0.6rem 1rem;border-radius:8px;border:1px solid rgba(252,129,129,0.2);background:rgba(252,129,129,0.07);color:var(--danger);font-family:'Nunito',sans-serif;font-size:0.82rem;font-weight:700;cursor:pointer;transition:all 0.2s}
.logout-btn:hover{background:rgba(252,129,129,0.15)}

/* MAIN */
.main{margin-left:240px;min-height:100vh;padding:2.5rem 2.5rem 4rem}
.page-header{margin-bottom:2rem}
.page-header h1{font-family:'Rajdhani',sans-serif;font-size:2rem;font-weight:700}
.page-header p{color:var(--text-dim);margin-top:0.3rem;font-size:0.88rem}
.panel{display:none}
.panel.active{display:block}

/* STATS */
.stats-overview{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:1rem;margin-bottom:2rem}
.stat-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem 1.4rem}
.stat-card .sc-label{font-size:0.7rem;font-weight:800;letter-spacing:0.1em;text-transform:uppercase;color:var(--text-dim)}
.stat-card .sc-val{font-family:'Rajdhani',sans-serif;font-size:2rem;font-weight:700;margin-top:0.3rem}
.stat-card .sc-sub{font-size:0.73rem;color:var(--text-muted);margin-top:0.15rem}
.stat-card.blue .sc-val{color:var(--accent)}
.stat-card.green .sc-val{color:var(--accent2)}
.stat-card.orange .sc-val{color:var(--accent3)}
.stat-card.red .sc-val{color:var(--danger)}

/* TABS inside panels */
.inner-tabs{display:flex;gap:0.4rem;flex-wrap:wrap;margin-bottom:2rem;border-bottom:1px solid var(--border)}
.inner-tab{padding:0.65rem 1.2rem;background:none;border:none;border-bottom:2px solid transparent;color:var(--text-dim);font-family:'Nunito',sans-serif;font-size:0.85rem;font-weight:800;cursor:pointer;transition:all 0.2s;margin-bottom:-1px}
.inner-tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.inner-tab:hover{color:var(--text)}
.inner-panel{display:none}
.inner-panel.active{display:block}

/* UPLOAD */
.upload-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:2rem;margin-bottom:1.5rem}
.upload-card h3{font-family:'Rajdhani',sans-serif;font-size:1.3rem;font-weight:700;margin-bottom:1.5rem;display:flex;align-items:center;gap:8px}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem}
.form-row.one{grid-template-columns:1fr}
.form-group{display:flex;flex-direction:column;gap:0.4rem}
.form-group label{font-size:0.73rem;font-weight:800;letter-spacing:0.08em;text-transform:uppercase;color:var(--text-dim)}
.form-group select,.form-group input[type="text"],.form-group input[type="url"],.form-group textarea{background:var(--bg);border:1px solid var(--border);color:var(--text);padding:0.7rem 0.9rem;border-radius:9px;font-family:'Nunito',sans-serif;font-size:0.88rem;outline:none;transition:border-color 0.2s,box-shadow 0.2s}
.form-group select:focus,.form-group input:focus,.form-group textarea:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(99,179,237,0.1)}
.form-group textarea{resize:vertical;min-height:80px}

/* DROP ZONE */
.drop-zone{border:2px dashed var(--border);border-radius:12px;padding:2.5rem;text-align:center;cursor:pointer;transition:all 0.25s;position:relative;overflow:hidden;background:rgba(99,179,237,0.02)}
.drop-zone:hover,.drop-zone.dragover{border-color:var(--accent);background:rgba(99,179,237,0.06)}
.drop-zone input[type="file"]{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%}
.drop-icon{font-size:2.5rem;margin-bottom:0.8rem}
.drop-zone h4{font-weight:800;font-size:0.95rem;margin-bottom:0.4rem}
.drop-zone p{font-size:0.78rem;color:var(--text-dim)}
.file-types{display:flex;gap:0.4rem;justify-content:center;flex-wrap:wrap;margin-top:0.8rem}
.ftt{padding:0.2rem 0.6rem;border-radius:50px;font-size:0.65rem;font-weight:800;background:rgba(99,179,237,0.1);color:var(--accent);border:1px solid rgba(99,179,237,0.2)}
#selected-files{margin-top:1rem}
.sel-file{display:flex;align-items:center;gap:10px;padding:0.75rem 1rem;background:rgba(104,211,145,0.07);border:1px solid rgba(104,211,145,0.2);border-radius:9px;margin-bottom:0.5rem}
.sel-file .sf-icon{font-size:1.2rem;flex-shrink:0}
.sel-file .sf-info{flex:1}
.sel-file .sf-name{font-size:0.85rem;font-weight:700}
.sel-file .sf-size{font-size:0.72rem;color:var(--text-dim)}
.sel-file .sf-remove{background:none;border:none;color:var(--danger);cursor:pointer;font-size:1rem;padding:0.2rem}
.progress-bar-wrap{background:rgba(99,179,237,0.1);border-radius:50px;height:8px;overflow:hidden;margin-top:0.8rem;display:none}
.progress-bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));border-radius:50px;width:0%;transition:width 0.4s ease}

/* VIDEO LINK FORM */
.video-link-form{background:rgba(246,173,85,0.06);border:1px solid rgba(246,173,85,0.2);border-radius:12px;padding:1.5rem;margin-top:1rem}
.video-link-form h4{font-family:'Rajdhani',sans-serif;font-size:1.1rem;margin-bottom:1rem;color:var(--accent3);display:flex;align-items:center;gap:8px}
.video-preview{margin-top:1rem;border-radius:10px;overflow:hidden;display:none}
.video-preview iframe{width:100%;height:220px;border:none}

/* BTNS */
.btn-upload{display:inline-flex;align-items:center;gap:8px;padding:0.85rem 2rem;border:none;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));color:var(--bg);font-family:'Nunito',sans-serif;font-size:0.92rem;font-weight:800;cursor:pointer;transition:all 0.25s;box-shadow:0 0 20px rgba(99,179,237,0.25);margin-top:1.2rem}
.btn-upload:hover{transform:translateY(-2px);box-shadow:0 0 35px rgba(99,179,237,0.4)}
.btn-upload:disabled{opacity:0.5;cursor:not-allowed;transform:none}
.btn-upload.orange{background:linear-gradient(135deg,var(--accent3),#e88a2a)}

/* FILES TABLE */
.files-toolbar{display:flex;gap:0.75rem;align-items:center;flex-wrap:wrap;margin-bottom:1.5rem}
.search-box{flex:1;min-width:200px;background:var(--surface);border:1px solid var(--border);color:var(--text);padding:0.65rem 1rem;border-radius:9px;font-family:'Nunito',sans-serif;font-size:0.88rem;outline:none;transition:border-color 0.2s}
.search-box:focus{border-color:var(--accent)}
.filter-select{background:var(--surface);border:1px solid var(--border);color:var(--text);padding:0.65rem 1rem;border-radius:9px;font-family:'Nunito',sans-serif;font-size:0.85rem;outline:none;cursor:pointer}
.files-table{width:100%;border-collapse:collapse}
.files-table th{text-align:left;padding:0.7rem 1rem;font-size:0.7rem;font-weight:800;letter-spacing:0.1em;text-transform:uppercase;color:var(--text-dim);border-bottom:1px solid var(--border)}
.files-table td{padding:0.85rem 1rem;border-bottom:1px solid rgba(255,255,255,0.04);font-size:0.85rem;vertical-align:middle}
.files-table tr:hover td{background:rgba(255,255,255,0.02)}
.file-name-cell{display:flex;align-items:center;gap:10px}
.file-ext{width:36px;height:36px;border-radius:8px;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:1.1rem}
.ext-pdf{background:rgba(252,129,129,0.12)}.ext-doc{background:rgba(99,179,237,0.12)}.ext-ppt{background:rgba(246,173,85,0.12)}.ext-zip{background:rgba(183,148,244,0.12)}.ext-vid{background:rgba(252,129,129,0.2)}.ext-img{background:rgba(104,211,145,0.12)}.ext-other{background:rgba(113,128,150,0.12)}
.fn-title{font-weight:700;font-size:0.88rem}
.fn-desc{font-size:0.72rem;color:var(--text-dim);margin-top:0.1rem}
.group-pill{display:inline-block;padding:0.22rem 0.7rem;border-radius:50px;font-size:0.68rem;font-weight:800;letter-spacing:0.08em;text-transform:uppercase}
.pill-m{background:rgba(99,179,237,0.12);color:var(--accent);border:1px solid rgba(99,179,237,0.2)}
.pill-v{background:rgba(246,173,85,0.12);color:var(--accent3);border:1px solid rgba(246,173,85,0.2)}
.pill-s{background:rgba(183,148,244,0.12);color:#b794f4;border:1px solid rgba(183,148,244,0.2)}
.pill-all{background:rgba(104,211,145,0.12);color:var(--accent2);border:1px solid rgba(104,211,145,0.2)}
.action-btns{display:flex;gap:0.4rem}
.btn-sm{padding:0.35rem 0.75rem;border-radius:7px;font-size:0.75rem;font-weight:700;cursor:pointer;border:1px solid;transition:all 0.18s;font-family:'Nunito',sans-serif;text-decoration:none;display:inline-flex;align-items:center;gap:5px}
.btn-copy{background:rgba(99,179,237,0.1);border-color:rgba(99,179,237,0.25);color:var(--accent)}
.btn-copy:hover{background:rgba(99,179,237,0.2)}
.btn-delete{background:rgba(252,129,129,0.1);border-color:rgba(252,129,129,0.2);color:var(--danger)}
.btn-delete:hover{background:rgba(252,129,129,0.2)}
.btn-view{background:rgba(104,211,145,0.1);border-color:rgba(104,211,145,0.2);color:var(--accent2)}
.btn-view:hover{background:rgba(104,211,145,0.2)}
.empty-state{text-align:center;padding:4rem 2rem;color:var(--text-dim)}
.empty-state .es-icon{font-size:3rem;margin-bottom:1rem;opacity:0.5}
.empty-state h4{font-weight:700;margin-bottom:0.4rem}

/* ‚ïê‚ïê RUEDA CROM√ÅTICA ‚ïê‚ïê */
#panel-color{padding-bottom:3rem}
.color-layout{display:grid;grid-template-columns:1fr 1fr;gap:2rem;align-items:start}
.wheel-wrap{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:1.5rem;text-align:center}
.wheel-wrap h3{font-family:'Rajdhani',sans-serif;font-size:1.2rem;font-weight:700;margin-bottom:1.2rem}
#colorWheel{border-radius:50%;cursor:crosshair;touch-action:none}
.wheel-controls{margin-top:1rem;display:flex;flex-direction:column;gap:0.75rem}
.wheel-controls label{font-size:0.73rem;font-weight:800;color:var(--text-dim);letter-spacing:0.08em;text-transform:uppercase;margin-bottom:0.2rem;display:block}
.wheel-controls input[type="range"]{width:100%;accent-color:var(--accent)}
.selected-color-box{width:100%;height:60px;border-radius:10px;border:1px solid var(--border);margin-top:0.5rem;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:1rem;transition:all 0.2s;cursor:pointer}
.palettes-wrap{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:1.5rem}
.palettes-wrap h3{font-family:'Rajdhani',sans-serif;font-size:1.2rem;font-weight:700;margin-bottom:1.2rem}
.harmony-btns{display:flex;gap:0.5rem;flex-wrap:wrap;margin-bottom:1.2rem}
.h-btn{padding:0.4rem 0.85rem;border-radius:7px;border:1px solid var(--border);background:none;color:var(--text-dim);font-family:'Nunito',sans-serif;font-size:0.78rem;font-weight:700;cursor:pointer;transition:all 0.2s}
.h-btn.active,.h-btn:hover{background:rgba(99,179,237,0.12);border-color:var(--accent);color:var(--accent)}
.palette-row{display:flex;gap:0.5rem;flex-wrap:wrap;margin-bottom:1rem}
.swatch{width:52px;height:52px;border-radius:10px;cursor:pointer;border:2px solid transparent;transition:all 0.2s;position:relative;flex-shrink:0}
.swatch:hover{transform:scale(1.1);border-color:rgba(255,255,255,0.4)}
.swatch-val{font-size:0.58rem;font-weight:800;text-align:center;margin-top:0.3rem;color:var(--text-dim);word-break:break-all;width:52px}
.swatch-group{display:flex;flex-direction:column;align-items:center}
.copy-hint{font-size:0.72rem;color:var(--text-dim);margin-top:0.3rem}
.color-info-box{background:rgba(99,179,237,0.06);border:1px solid rgba(99,179,237,0.15);border-radius:10px;padding:1rem;margin-top:1rem}
.color-info-box h4{font-weight:800;font-size:0.85rem;margin-bottom:0.6rem;color:var(--accent)}
.cib-row{display:flex;gap:0.5rem;margin-bottom:0.4rem}
.cib-tag{background:var(--bg);border:1px solid var(--border);border-radius:7px;padding:0.3rem 0.7rem;font-size:0.78rem;font-weight:700;cursor:pointer;transition:all 0.2s;flex:1;text-align:center}
.cib-tag:hover{border-color:var(--accent);color:var(--accent)}
.saved-palette{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1rem;margin-top:1rem}
.saved-palette h4{font-weight:800;font-size:0.85rem;margin-bottom:0.8rem}
.saved-swatches{display:flex;gap:0.4rem;flex-wrap:wrap}
.btn-save-pal{display:inline-flex;align-items:center;gap:6px;margin-top:1rem;padding:0.55rem 1.1rem;border:none;border-radius:8px;background:linear-gradient(135deg,var(--accent),var(--accent2));color:var(--bg);font-family:'Nunito',sans-serif;font-size:0.82rem;font-weight:800;cursor:pointer}

/* ‚ïê‚ïê IA PANEL ‚ïê‚ïê */
.ia-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;margin-bottom:2rem}
.ia-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:1.8rem;text-decoration:none;color:var(--text);transition:all 0.25s;display:block;position:relative;overflow:hidden}
.ia-card::before{content:'';position:absolute;inset:0;opacity:0;transition:opacity 0.25s;background:var(--ia-glow)}
.ia-card:hover{transform:translateY(-5px);box-shadow:0 20px 50px rgba(0,0,0,0.3)}
.ia-card:hover::before{opacity:1}
.ia-card .ia-logo{font-size:3rem;margin-bottom:1rem;position:relative;z-index:1}
.ia-card h3{font-family:'Rajdhani',sans-serif;font-size:1.4rem;font-weight:700;margin-bottom:0.5rem;position:relative;z-index:1}
.ia-card p{font-size:0.82rem;color:var(--text-dim);line-height:1.65;position:relative;z-index:1}
.ia-card .ia-badge{display:inline-block;margin-top:1rem;padding:0.3rem 0.8rem;border-radius:50px;font-size:0.7rem;font-weight:800;letter-spacing:0.1em;text-transform:uppercase;position:relative;z-index:1}
.ia-card.gemini{--ia-glow:linear-gradient(135deg,rgba(66,133,244,0.08),rgba(52,168,83,0.08))}
.ia-card.gemini .ia-badge{background:rgba(66,133,244,0.15);color:#4285f4;border:1px solid rgba(66,133,244,0.3)}
.ia-card.copilot{--ia-glow:linear-gradient(135deg,rgba(0,120,212,0.08),rgba(80,200,255,0.08))}
.ia-card.copilot .ia-badge{background:rgba(0,120,212,0.15);color:#0078d4;border:1px solid rgba(0,120,212,0.3)}
.ia-card.chatgpt{--ia-glow:linear-gradient(135deg,rgba(16,163,127,0.08),rgba(0,0,0,0))}
.ia-card.chatgpt .ia-badge{background:rgba(16,163,127,0.15);color:#10a37f;border:1px solid rgba(16,163,127,0.3)}
.ia-card.perplexity{--ia-glow:linear-gradient(135deg,rgba(99,179,237,0.08),rgba(0,0,0,0))}
.ia-card.perplexity .ia-badge{background:rgba(99,179,237,0.15);color:var(--accent);border:1px solid rgba(99,179,237,0.3)}

.ia-embed{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:1.5rem;margin-top:1.5rem}
.ia-embed h3{font-family:'Rajdhani',sans-serif;font-size:1.2rem;font-weight:700;margin-bottom:1.2rem;display:flex;align-items:center;gap:8px}
.ia-frame{width:100%;height:600px;border:none;border-radius:10px;background:#000}
.ia-tabs{display:flex;gap:0.5rem;margin-bottom:1rem;flex-wrap:wrap}
.ia-tab-btn{padding:0.45rem 1rem;border-radius:8px;border:1px solid var(--border);background:none;color:var(--text-dim);font-family:'Nunito',sans-serif;font-size:0.82rem;font-weight:700;cursor:pointer;transition:all 0.2s}
.ia-tab-btn.active{background:rgba(99,179,237,0.12);border-color:var(--accent);color:var(--accent)}

/* SETTINGS */
.settings-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem}
.settings-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:1.8rem}
.settings-card h3{font-family:'Rajdhani',sans-serif;font-size:1.2rem;font-weight:700;margin-bottom:1.2rem;display:flex;align-items:center;gap:8px}
.btn-save{padding:0.65rem 1.4rem;border:none;border-radius:9px;background:linear-gradient(135deg,var(--accent),var(--accent2));color:var(--bg);font-family:'Nunito',sans-serif;font-size:0.85rem;font-weight:800;cursor:pointer;transition:all 0.2s;margin-top:1rem}
.btn-save:hover{transform:translateY(-1px);box-shadow:0 4px 15px rgba(99,179,237,0.3)}
.guide-step{background:rgba(99,179,237,0.06);border:1px solid rgba(99,179,237,0.15);border-radius:10px;padding:1.2rem;margin-bottom:0.75rem}
.guide-step .gs-num{font-family:'Rajdhani',sans-serif;font-size:1.4rem;font-weight:700;color:var(--accent);margin-bottom:0.4rem}
.guide-step h5{font-weight:800;font-size:0.9rem;margin-bottom:0.5rem}
.guide-step p{font-size:0.8rem;color:var(--text-dim);line-height:1.65}
.guide-step code{background:rgba(99,179,237,0.15);color:var(--accent);padding:0.1rem 0.4rem;border-radius:4px;font-family:monospace;font-size:0.82rem}
.guide-step a{color:var(--accent2);font-weight:700}

/* MODAL */
.modal-bg{position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(6px);z-index:500;display:none;align-items:center;justify-content:center}
.modal-bg.open{display:flex}
.modal-box{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:2rem;max-width:420px;width:90%}
.modal-box h3{font-family:'Rajdhani',sans-serif;font-size:1.4rem;margin-bottom:0.7rem}
.modal-box p{font-size:0.85rem;color:var(--text-dim);line-height:1.7;margin-bottom:1.5rem}
.modal-btns{display:flex;gap:0.75rem;justify-content:flex-end}
.btn-cancel{padding:0.6rem 1.2rem;border-radius:8px;border:1px solid var(--border);background:none;color:var(--text-dim);font-family:'Nunito',sans-serif;font-size:0.85rem;font-weight:700;cursor:pointer}
.btn-confirm-del{padding:0.6rem 1.2rem;border-radius:8px;border:none;background:var(--danger);color:white;font-family:'Nunito',sans-serif;font-size:0.85rem;font-weight:800;cursor:pointer}

/* TOAST */
.toast-container{position:fixed;bottom:2rem;right:2rem;z-index:9999;display:flex;flex-direction:column;gap:0.6rem}
.toast{padding:0.9rem 1.4rem;border-radius:10px;font-size:0.85rem;font-weight:700;box-shadow:0 8px 30px rgba(0,0,0,0.3);animation:slideIn 0.3s ease;min-width:280px;max-width:380px;display:flex;align-items:center;gap:10px}
@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes slideOut{from{transform:translateX(0);opacity:1}to{transform:translateX(110%);opacity:0}}
.toast.success{background:#1a3a2a;border:1px solid rgba(104,211,145,0.3);color:var(--accent2)}
.toast.error{background:#3a1a1a;border:1px solid rgba(252,129,129,0.3);color:var(--danger)}
.toast.info{background:#1a2a3a;border:1px solid rgba(99,179,237,0.3);color:var(--accent)}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid rgba(6,13,24,0.3);border-top-color:var(--bg);border-radius:50%;animation:spin 0.7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
@media(max-width:768px){.sidebar{transform:translateX(-100%)}.main{margin-left:0;padding:1.5rem}.form-row{grid-template-columns:1fr}.settings-grid{grid-template-columns:1fr}.ia-grid{grid-template-columns:1fr}.color-layout{grid-template-columns:1fr}}
</style>
</head>
<body>

<!-- ‚ïê‚ïê LOGIN ‚ïê‚ïê -->
<div id="login-screen">
  <div class="login-box">
    <div class="login-logo">
      <div class="badge">GC</div>
      <h1>Panel Docente</h1>
      <p>AULA DIGITAL ¬∑ GRUPO CENTED ALTAVISTA</p>
    </div>
    <div class="field">
      <label>Usuario</label>
      <input type="text" id="login-user" placeholder="Wicho-alv503" autocomplete="username"/>
    </div>
    <div class="field">
      <label>Contrase√±a</label>
      <input type="password" id="login-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password"/>
    </div>
    <div class="field">
      <label>GitHub Token</label>
      <input type="password" id="login-token" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx"/>
      <div class="token-steps">
        <p>
          <b>¬øC√≥mo obtener tu token?</b><br/>
          1. Ve a <a href="https://github.com/settings/tokens/new" target="_blank">github.com/settings/tokens/new</a><br/>
          2. Note: <b>Panel CENTED</b> ¬∑ Expiration: <b>No expiration</b><br/>
          3. Marca ‚úÖ <b>repo</b> (primer checkbox)<br/>
          4. Clic en <b>Generate token</b> y copia el c√≥digo <b>ghp_...</b><br/>
          5. P√©galo aqu√≠. Se guarda en tu navegador.
        </p>
      </div>
    </div>
    <button class="btn-login" onclick="doLogin()">Ingresar al panel ‚Üí</button>
    <div class="login-error" id="login-error">Usuario o contrase√±a incorrectos.</div>
  </div>
</div>

<!-- ‚ïê‚ïê APP ‚ïê‚ïê -->
<div id="app">
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="s-badge">GC</div>
      <h2>CENTED Admin</h2>
      <span>Panel Docente</span>
    </div>
    <div class="sidebar-repo">
      <div class="repo-label">Repositorio</div>
      <div class="repo-name" id="sidebar-repo-name">BryanD10/Aulavirtual.github.io</div>
    </div>
    <div class="nav-section">Principal</div>
    <div class="nav-item active" onclick="showPanel('dashboard',this)"><span class="ni">üìä</span> Dashboard</div>
    <div class="nav-item" onclick="showPanel('upload',this)"><span class="ni">‚¨ÜÔ∏è</span> Subir archivo</div>
    <div class="nav-item" onclick="showPanel('video',this)"><span class="ni">üé¨</span> Agregar video</div>
    <div class="nav-item" onclick="showPanel('files',this)"><span class="ni">üìÇ</span> Mis archivos</div>
    <div class="nav-section">Herramientas</div>
    <div class="nav-item" onclick="showPanel('color',this)"><span class="ni">üé®</span> Rueda Crom√°tica</div>
    <div class="nav-item" onclick="showPanel('ia',this)"><span class="ni">ü§ñ</span> Asistentes IA</div>
    <div class="nav-section">Ajustes</div>
    <div class="nav-item" onclick="showPanel('settings',this)"><span class="ni">‚öôÔ∏è</span> Configuraci√≥n</div>
    <div class="nav-item" onclick="window.open('index.html','_blank')"><span class="ni">üåê</span> Ver aula</div>
    <div class="sidebar-footer">
      <button class="logout-btn" onclick="doLogout()">üö™ Cerrar sesi√≥n</button>
    </div>
  </aside>

  <main class="main">

    <!-- DASHBOARD -->
    <div class="panel active" id="panel-dashboard">
      <div class="page-header">
        <h1>üìä Dashboard</h1>
        <p>Bienvenido, <strong>Wicho</strong> ¬∑ BryanD10/Aulavirtual.github.io</p>
      </div>
      <div class="stats-overview">
        <div class="stat-card blue"><div class="sc-label">Archivos totales</div><div class="sc-val" id="stat-total">‚Äî</div><div class="sc-sub">documentos y videos</div></div>
        <div class="stat-card green"><div class="sc-label">Matutino</div><div class="sc-val" id="stat-mat">‚Äî</div></div>
        <div class="stat-card orange"><div class="sc-label">Vespertino</div><div class="sc-val" id="stat-ves">‚Äî</div></div>
        <div class="stat-card red"><div class="sc-label">Sabatino</div><div class="sc-val" id="stat-sab">‚Äî</div></div>
      </div>
      <div style="background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:1.8rem">
        <h3 style="font-family:'Rajdhani',sans-serif;font-size:1.2rem;font-weight:700;margin-bottom:1.2rem">üïê Archivos recientes</h3>
        <div id="recent-files"><div class="empty-state"><div class="es-icon">üì≠</div><h4>Sin archivos</h4><p>Configura el repositorio y sube el primer documento.</p></div></div>
      </div>
    </div>

    <!-- UPLOAD ARCHIVO -->
    <div class="panel" id="panel-upload">
      <div class="page-header">
        <h1>‚¨ÜÔ∏è Subir Documento</h1>
        <p>El archivo se sube directo a GitHub y queda disponible para los alumnos al instante.</p>
      </div>
      <div class="upload-card">
        <h3>üìã Informaci√≥n del documento</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Grupo destino</label>
            <select id="up-group">
              <option value="matutino">üåÖ Grupo Matutino</option>
              <option value="vespertino">üåá Grupo Vespertino</option>
              <option value="sabatino">üìö Grupo Sabatino</option>
              <option value="todos">üåê Todos los grupos</option>
            </select>
          </div>
          <div class="form-group">
            <label>Categor√≠a / Materia</label>
            <select id="up-category">
              <option value="informatica">üíª Inform√°tica (I_I)</option>
              <option value="ofimatica">üìä Ofim√°tica (M_O)</option>
              <option value="diseno">üé® Dise√±o Gr√°fico (D_G)</option>
              <option value="redes">üåê Redes y Datos (D_R_D)</option>
              <option value="bases-datos">üóÑÔ∏è Bases de Datos (M_B_D)</option>
              <option value="mantenimiento">üîß Mantenimiento (S_M_C)</option>
              <option value="general">üìå General</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>T√≠tulo del documento</label>
            <input type="text" id="up-title" placeholder="Ej: Gu√≠a de Dise√±o ‚Äî Unidad 2"/>
          </div>
          <div class="form-group">
            <label>Unidad / Semana</label>
            <input type="text" id="up-unit" placeholder="Ej: Unidad 1"/>
          </div>
        </div>
        <div class="form-row one">
          <div class="form-group">
            <label>Descripci√≥n breve</label>
            <textarea id="up-desc" placeholder="Breve descripci√≥n del contenido..."></textarea>
          </div>
        </div>
      </div>
      <div class="upload-card">
        <h3>üìÅ Seleccionar archivo</h3>
        <div class="drop-zone" id="drop-zone">
          <input type="file" id="file-input" multiple accept=".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.zip,.rar,.png,.jpg,.jpeg,.txt,.mp4,.mov,.avi" onchange="handleFiles(this.files)"/>
          <div class="drop-icon">üìÇ</div>
          <h4>Arrastra aqu√≠ o haz clic para seleccionar</h4>
          <p>M√°ximo 25 MB por archivo</p>
          <div class="file-types">
            <span class="ftt">PDF</span><span class="ftt">DOCX</span><span class="ftt">PPTX</span><span class="ftt">XLSX</span><span class="ftt">ZIP</span><span class="ftt">JPG/PNG</span><span class="ftt">MP4</span>
          </div>
        </div>
        <div id="selected-files"></div>
        <div class="progress-bar-wrap" id="progress-wrap"><div class="progress-bar" id="progress-bar"></div></div>
        <button class="btn-upload" id="btn-upload" onclick="uploadFiles()">
          <span id="upload-btn-text">‚¨ÜÔ∏è Subir a GitHub</span>
        </button>
      </div>
    </div>

    <!-- AGREGAR VIDEO -->
    <div class="panel" id="panel-video">
      <div class="page-header">
        <h1>üé¨ Agregar Video</h1>
        <p>Agrega links de YouTube u otros videos para los alumnos. Se guarda en GitHub como referencia.</p>
      </div>
      <div class="upload-card">
        <h3>üìã Datos del video</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Grupo destino</label>
            <select id="vid-group">
              <option value="matutino">üåÖ Matutino</option>
              <option value="vespertino">üåá Vespertino</option>
              <option value="sabatino">üìö Sabatino</option>
              <option value="todos">üåê Todos</option>
            </select>
          </div>
          <div class="form-group">
            <label>Categor√≠a</label>
            <select id="vid-category">
              <option value="informatica">üíª Inform√°tica</option>
              <option value="ofimatica">üìä Ofim√°tica</option>
              <option value="diseno">üé® Dise√±o</option>
              <option value="redes">üåê Redes</option>
              <option value="bases-datos">üóÑÔ∏è Bases de Datos</option>
              <option value="general">üìå General</option>
            </select>
          </div>
        </div>
        <div class="form-row one">
          <div class="form-group">
            <label>T√≠tulo del video</label>
            <input type="text" id="vid-title" placeholder="Ej: Tutorial Photoshop ‚Äî Capas y M√°scaras"/>
          </div>
        </div>
        <div class="form-row one">
          <div class="form-group">
            <label>URL del video (YouTube, Drive, etc.)</label>
            <input type="url" id="vid-url" placeholder="https://www.youtube.com/watch?v=..." oninput="previewVideo()"/>
          </div>
        </div>
        <div class="form-row one">
          <div class="form-group">
            <label>Descripci√≥n</label>
            <textarea id="vid-desc" placeholder="¬øQu√© aprender√°n con este video?"></textarea>
          </div>
        </div>
        <div class="video-link-form" id="vid-preview-box">
          <h4>üëÅ Vista previa</h4>
          <div class="video-preview" id="vid-preview">
            <iframe id="vid-iframe" allowfullscreen></iframe>
          </div>
          <p id="vid-preview-msg" style="font-size:0.82rem;color:var(--text-dim)">Ingresa una URL de YouTube para ver la vista previa.</p>
        </div>
        <button class="btn-upload orange" onclick="saveVideoLink()">üé¨ Guardar link de video</button>
      </div>
    </div>

    <!-- FILES -->
    <div class="panel" id="panel-files">
      <div class="page-header">
        <h1>üìÇ Archivos y Videos</h1>
        <p>Gestiona todos los materiales del repositorio.</p>
      </div>
      <div class="files-toolbar">
        <input class="search-box" type="text" placeholder="üîç Buscar..." id="search-input" oninput="filterFiles()"/>
        <select class="filter-select" id="filter-group" onchange="filterFiles()">
          <option value="">Todos los grupos</option>
          <option value="matutino">üåÖ Matutino</option>
          <option value="vespertino">üåá Vespertino</option>
          <option value="sabatino">üìö Sabatino</option>
          <option value="todos">üåê Todos</option>
        </select>
        <select class="filter-select" id="filter-type" onchange="filterFiles()">
          <option value="">Todos los tipos</option>
          <option value="doc">Documentos</option>
          <option value="video">Videos</option>
          <option value="img">Im√°genes</option>
        </select>
        <button class="btn-sm btn-copy" onclick="loadFiles()" style="border-radius:9px;padding:0.55rem 1rem">üîÑ Actualizar</button>
      </div>
      <div id="files-table-wrap"><div class="empty-state"><div class="es-icon">üì≠</div><h4>Cargando...</h4></div></div>
    </div>

    <!-- RUEDA CROM√ÅTICA -->
    <div class="panel" id="panel-color">
      <div class="page-header">
        <h1>üé® Rueda Crom√°tica</h1>
        <p>Selecciona colores y genera paletas arm√≥nicas para tus dise√±os y materiales.</p>
      </div>
      <div class="color-layout">
        <div>
          <div class="wheel-wrap">
            <h3>üé° Selector de color</h3>
            <canvas id="colorWheel" width="260" height="260"></canvas>
            <div class="wheel-controls">
              <div>
                <label>Brillo</label>
                <input type="range" id="brightness" min="0" max="100" value="100" oninput="drawWheel()"/>
              </div>
              <div>
                <label>Saturaci√≥n</label>
                <input type="range" id="saturation" min="0" max="100" value="100" oninput="drawWheel()"/>
              </div>
            </div>
            <div id="selected-color-box" class="selected-color-box" style="background:#ff0000;color:#fff" onclick="copyHex()" title="Clic para copiar">
              #FF0000 ‚Äî Clic para copiar
            </div>
            <div class="color-info-box" id="color-info-box">
              <h4>Valores del color</h4>
              <div class="cib-row">
                <div class="cib-tag" id="hex-val" onclick="copyText(this.textContent)" title="Copiar HEX">#FF0000</div>
                <div class="cib-tag" id="rgb-val" onclick="copyText(this.textContent)" title="Copiar RGB">rgb(255,0,0)</div>
              </div>
              <div class="cib-row">
                <div class="cib-tag" id="hsl-val" onclick="copyText(this.textContent)" title="Copiar HSL">hsl(0,100%,50%)</div>
                <div class="cib-tag" id="cmyk-val" onclick="copyText(this.textContent)" title="Copiar CMYK">C:0 M:100 Y:100 K:0</div>
              </div>
              <p style="font-size:0.7rem;color:var(--text-muted);margin-top:0.5rem">Clic en cualquier valor para copiarlo</p>
            </div>
          </div>
          <div class="saved-palette" style="margin-top:1rem">
            <h4>üíæ Paleta guardada</h4>
            <div class="saved-swatches" id="saved-swatches">
              <p style="font-size:0.78rem;color:var(--text-dim)">Agrega colores con el bot√≥n de abajo</p>
            </div>
            <div style="display:flex;gap:0.5rem;margin-top:1rem;flex-wrap:wrap">
              <button class="btn-save-pal" onclick="addToSaved()">‚ûï Agregar color</button>
              <button class="btn-save-pal" style="background:linear-gradient(135deg,var(--danger),#e53e3e)" onclick="clearSaved()">üóë Limpiar</button>
              <button class="btn-save-pal" style="background:linear-gradient(135deg,var(--accent3),#e88a2a)" onclick="exportPalette()">üìã Exportar CSS</button>
            </div>
          </div>
        </div>
        <div class="palettes-wrap">
          <h3>üé≠ Paletas arm√≥nicas</h3>
          <div class="harmony-btns">
            <button class="h-btn active" onclick="setHarmony('complementario',this)">Complementario</button>
            <button class="h-btn" onclick="setHarmony('analogos',this)">An√°logos</button>
            <button class="h-btn" onclick="setHarmony('triadico',this)">Tri√°dico</button>
            <button class="h-btn" onclick="setHarmony('tetradico',this)">Tetr√°dico</button>
            <button class="h-btn" onclick="setHarmony('split',this)">Split-comp</button>
            <button class="h-btn" onclick="setHarmony('monocromatico',this)">Monocrom√°tico</button>
          </div>
          <div id="harmony-palette" class="palette-row"></div>
          <div style="margin-top:1.5rem">
            <h3 style="font-family:'Rajdhani',sans-serif;font-size:1.1rem;font-weight:700;margin-bottom:1rem">üåà Gradientes sugeridos</h3>
            <div id="gradient-preview" style="display:grid;gap:0.75rem"></div>
          </div>
          <div style="margin-top:1.5rem">
            <h3 style="font-family:'Rajdhani',sans-serif;font-size:1.1rem;font-weight:700;margin-bottom:1rem">üìê Contraste de texto</h3>
            <div id="contrast-box" style="border-radius:10px;padding:1rem;text-align:center;font-weight:800;font-size:1.1rem;transition:all 0.2s">
              Texto oscuro sobre tu color
            </div>
            <div id="contrast-box2" style="border-radius:10px;padding:1rem;text-align:center;font-weight:800;font-size:1.1rem;margin-top:0.5rem;transition:all 0.2s">
              Texto claro sobre tu color
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ASISTENTES IA -->
    <div class="panel" id="panel-ia">
      <div class="page-header">
        <h1>ü§ñ Asistentes de IA</h1>
        <p>Accede directamente a los asistentes de inteligencia artificial sin necesidad de iniciar sesi√≥n.</p>
      </div>
      <div class="ia-grid">
        <a href="https://gemini.google.com/app" target="_blank" class="ia-card gemini">
          <div class="ia-logo">‚ú®</div>
          <h3>Google Gemini</h3>
          <p>El asistente de IA de Google. Excelente para responder preguntas, crear contenido, analizar im√°genes y ayudar con tareas acad√©micas.</p>
          <span class="ia-badge">Abrir sin cuenta ‚Üí</span>
        </a>
        <a href="https://copilot.microsoft.com/" target="_blank" class="ia-card copilot">
          <div class="ia-logo">ü™ü</div>
          <h3>Microsoft Copilot</h3>
          <p>IA de Microsoft integrada con Bing. Ideal para b√∫squedas inteligentes, generaci√≥n de im√°genes con DALL-E y asistencia en Office.</p>
          <span class="ia-badge">Abrir sin cuenta ‚Üí</span>
        </a>
        <a href="https://chatgpt.com/" target="_blank" class="ia-card chatgpt">
          <div class="ia-logo">üß†</div>
          <h3>ChatGPT</h3>
          <p>El modelo GPT de OpenAI. Muy √∫til para redactar textos, explicar conceptos t√©cnicos, programar y resolver problemas complejos.</p>
          <span class="ia-badge">Abrir sin cuenta ‚Üí</span>
        </a>
        <a href="https://www.perplexity.ai/" target="_blank" class="ia-card perplexity">
          <div class="ia-logo">üîç</div>
          <h3>Perplexity AI</h3>
          <p>Motor de b√∫squeda con IA. Responde preguntas con fuentes verificadas en tiempo real. Ideal para investigaci√≥n y referencias.</p>
          <span class="ia-badge">Abrir sin cuenta ‚Üí</span>
        </a>
      </div>
      <div class="ia-embed">
        <h3>‚ö° Acceso r√°pido integrado</h3>
        <div class="ia-tabs">
          <button class="ia-tab-btn active" onclick="loadIA('https://gemini.google.com/app',this)">‚ú® Gemini</button>
          <button class="ia-tab-btn" onclick="loadIA('https://copilot.microsoft.com/',this)">ü™ü Copilot</button>
          <button class="ia-tab-btn" onclick="loadIA('https://chatgpt.com/',this)">üß† ChatGPT</button>
          <button class="ia-tab-btn" onclick="loadIA('https://www.perplexity.ai/',this)">üîç Perplexity</button>
        </div>
        <iframe id="ia-frame" class="ia-frame" src="https://gemini.google.com/app" sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation"></iframe>
        <p style="font-size:0.75rem;color:var(--text-muted);margin-top:0.7rem">‚ö†Ô∏è Si el asistente no carga aqu√≠, usa el bot√≥n "Abrir sin cuenta" de arriba para acceder directamente.</p>
      </div>
    </div>

    <!-- SETTINGS -->
    <div class="panel" id="panel-settings">
      <div class="page-header">
        <h1>‚öôÔ∏è Configuraci√≥n</h1>
        <p>Ajusta el repositorio, credenciales y opciones del panel.</p>
      </div>
      <div class="settings-grid">
        <div class="settings-card">
          <h3>üêô GitHub Repository</h3>
          <div class="form-group" style="margin-bottom:1rem">
            <label>Usuario de GitHub</label>
            <input type="text" id="cfg-user" value="BryanD10"/>
          </div>
          <div class="form-group" style="margin-bottom:1rem">
            <label>Nombre del repositorio</label>
            <input type="text" id="cfg-repo" value="Aulavirtual.github.io"/>
          </div>
          <div class="form-group" style="margin-bottom:1rem">
            <label>Rama principal</label>
            <input type="text" id="cfg-branch" value="main"/>
          </div>
          <div class="form-group">
            <label>Carpeta de archivos</label>
            <input type="text" id="cfg-folder" value="archivos"/>
          </div>
          <button class="btn-save" onclick="saveConfig()">üíæ Guardar</button>
        </div>
        <div class="settings-card">
          <h3>üîê Cambiar contrase√±a</h3>
          <div class="form-group" style="margin-bottom:1rem">
            <label>Nueva contrase√±a</label>
            <input type="password" id="cfg-newpass" placeholder="Nueva contrase√±a"/>
          </div>
          <div class="form-group">
            <label>Confirmar</label>
            <input type="password" id="cfg-newpass2" placeholder="Repetir"/>
          </div>
          <button class="btn-save" onclick="changePassword()">üîë Actualizar</button>
          <div style="margin-top:1.5rem;padding-top:1.2rem;border-top:1px solid var(--border)">
            <h3 style="font-size:1rem;margin-bottom:0.7rem">üåê URL del Aula</h3>
            <div id="public-url" style="font-size:0.82rem;color:var(--accent);word-break:break-all;background:rgba(99,179,237,0.07);padding:0.6rem 0.8rem;border-radius:8px;border:1px solid rgba(99,179,237,0.15)">https://bryand10.github.io/Aulavirtual.github.io/</div>
            <button class="btn-sm btn-copy" style="margin-top:0.6rem" onclick="navigator.clipboard.writeText(document.getElementById('public-url').textContent).then(()=>toast('üìã URL copiada','info'))">üìã Copiar</button>
          </div>
        </div>

        <!-- GU√çA TOKEN - FULL WIDTH -->
        <div class="settings-card" style="grid-column:1/-1">
          <h3>üîë Gu√≠a paso a paso: Crear tu GitHub Token</h3>
          <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1rem">
            <div class="guide-step">
              <div class="gs-num">01</div>
              <h5>Inicia sesi√≥n en GitHub</h5>
              <p>Ve a <a href="https://github.com/login" target="_blank">github.com/login</a> e ingresa con tu cuenta <code>BryanD10</code>.</p>
            </div>
            <div class="guide-step">
              <div class="gs-num">02</div>
              <h5>Ir a configuraci√≥n</h5>
              <p>Haz clic en tu foto de perfil (arriba derecha) ‚Üí <code>Settings</code> ‚Üí al final del men√∫ izquierdo ‚Üí <code>Developer settings</code>.</p>
            </div>
            <div class="guide-step">
              <div class="gs-num">03</div>
              <h5>Personal Access Tokens</h5>
              <p>Clic en <code>Personal access tokens</code> ‚Üí <code>Tokens (classic)</code> ‚Üí <code>Generate new token (classic)</code>.</p>
            </div>
            <div class="guide-step">
              <div class="gs-num">04</div>
              <h5>Configurar el token</h5>
              <p>Note: <code>Panel CENTED</code> ¬∑ Expiration: <code>No expiration</code> ¬∑ Marca ‚úÖ <code>repo</code> (el primer bloque completo).</p>
            </div>
            <div class="guide-step">
              <div class="gs-num">05</div>
              <h5>Copiar y guardar</h5>
              <p>Clic en <code>Generate token</code>. Copia el c√≥digo que empieza con <code>ghp_...</code>. ‚ö†Ô∏è Solo se muestra una vez.</p>
            </div>
            <div class="guide-step">
              <div class="gs-num">06</div>
              <h5>Pegar en el login</h5>
              <p>Al ingresar al panel, pega el token en el campo <code>GitHub Token</code>. Se guarda en tu navegador autom√°ticamente.</p>
            </div>
          </div>
          <div style="margin-top:1rem;padding:1rem;background:rgba(252,129,129,0.08);border:1px solid rgba(252,129,129,0.2);border-radius:10px">
            <p style="font-size:0.82rem;color:var(--danger)">‚ö†Ô∏è <strong>Importante:</strong> Tu token es como una contrase√±a de GitHub. No lo compartas con nadie. Si alguien m√°s lo tiene, puede modificar tu repositorio.</p>
          </div>
        </div>
      </div>
    </div>

  </main>
</div>

<!-- CONFIRM MODAL -->
<div class="modal-bg" id="confirm-modal">
  <div class="modal-box">
    <h3>‚ö†Ô∏è Confirmar eliminaci√≥n</h3>
    <p id="confirm-msg">¬øSeguro que deseas eliminar este archivo?</p>
    <div class="modal-btns">
      <button class="btn-cancel" onclick="closeConfirm()">Cancelar</button>
      <button class="btn-confirm-del" id="confirm-ok">Eliminar</button>
    </div>
  </div>
</div>

<div class="toast-container" id="toasts"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  CONFIG ‚Äî credenciales ya configuradas
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const ADMIN_USER = 'Wicho-alv503';
let ADMIN_PASS = localStorage.getItem('cented_pass') || 'Wicho-alv503';

const DEFAULT_CONFIG = {
  user:   'BryanD10',
  repo:   'Aulavirtual.github.io',
  branch: 'main',
  folder: 'archivos',
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  AUTH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function doLogin() {
  const u = document.getElementById('login-user').value.trim();
  const p = document.getElementById('login-pass').value;
  const t = document.getElementById('login-token').value.trim();
  if (u !== ADMIN_USER || p !== ADMIN_PASS) {
    document.getElementById('login-error').style.display = 'block';
    return;
  }
  if (t) { GH_TOKEN = t; localStorage.setItem('cented_token', t); }
  document.getElementById('login-screen').style.display = 'none';
  document.getElementById('app').style.display = 'block';
  initApp();
}
['login-pass','login-token'].forEach(id => {
  document.getElementById(id).addEventListener('keydown', e => { if(e.key==='Enter') doLogin(); });
});
function doLogout() {
  GH_TOKEN = '';
  document.getElementById('login-screen').style.display = 'flex';
  document.getElementById('app').style.display = 'none';
  document.getElementById('login-pass').value = '';
}

let GH_TOKEN = localStorage.getItem('cented_token') || '';

function initApp() {
  GH_TOKEN = GH_TOKEN || localStorage.getItem('cented_token') || '';
  loadConfigUI();
  loadFiles();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  CONFIG
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function getConfig() {
  return {
    user:   localStorage.getItem('cented_gh_user')   || DEFAULT_CONFIG.user,
    repo:   localStorage.getItem('cented_gh_repo')   || DEFAULT_CONFIG.repo,
    branch: localStorage.getItem('cented_gh_branch') || DEFAULT_CONFIG.branch,
    folder: localStorage.getItem('cented_gh_folder') || DEFAULT_CONFIG.folder,
  };
}
function loadConfigUI() {
  const c = getConfig();
  document.getElementById('cfg-user').value   = c.user;
  document.getElementById('cfg-repo').value   = c.repo;
  document.getElementById('cfg-branch').value = c.branch;
  document.getElementById('cfg-folder').value = c.folder;
}
function saveConfig() {
  localStorage.setItem('cented_gh_user',   document.getElementById('cfg-user').value.trim());
  localStorage.setItem('cented_gh_repo',   document.getElementById('cfg-repo').value.trim());
  localStorage.setItem('cented_gh_branch', document.getElementById('cfg-branch').value.trim() || 'main');
  localStorage.setItem('cented_gh_folder', document.getElementById('cfg-folder').value.trim() || 'archivos');
  toast('‚úÖ Configuraci√≥n guardada', 'success');
  loadFiles();
}
function changePassword() {
  const p1 = document.getElementById('cfg-newpass').value;
  const p2 = document.getElementById('cfg-newpass2').value;
  if (!p1) return toast('‚ö†Ô∏è Ingresa una contrase√±a', 'error');
  if (p1 !== p2) return toast('‚ö†Ô∏è Las contrase√±as no coinciden', 'error');
  ADMIN_PASS = p1; localStorage.setItem('cented_pass', p1);
  document.getElementById('cfg-newpass').value = '';
  document.getElementById('cfg-newpass2').value = '';
  toast('üîë Contrase√±a actualizada', 'success');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  PANELS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showPanel(id, el) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('panel-'+id).classList.add('active');
  if(el) el.classList.add('active');
  if(id==='files') loadFiles();
  if(id==='dashboard') loadFiles();
  if(id==='color') initColorWheel();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  GITHUB API
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function ghReq(method, path, body) {
  const token = GH_TOKEN || localStorage.getItem('cented_token');
  const res = await fetch(`https://api.github.com${path}`, {
    method,
    headers: {
      'Authorization': `token ${token}`,
      'Content-Type': 'application/json',
      'Accept': 'application/vnd.github.v3+json'
    },
    body: body ? JSON.stringify(body) : undefined
  });
  return res;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  LOAD FILES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let allFiles = [];
async function loadFiles() {
  const c = getConfig();
  let files = [];
  for (const g of ['matutino','vespertino','sabatino','todos']) {
    try {
      const res = await ghReq('GET', `/repos/${c.user}/${c.repo}/contents/${c.folder}/${g}`);
      if (res.ok) {
        const data = await res.json();
        if (Array.isArray(data)) data.forEach(f => { f._group = g; files.push(f); });
      }
    } catch(e) {}
  }
  allFiles = files;
  renderFilesTable(files);
  updateStats(files);
  renderRecent(files);
}

function renderFilesTable(files) {
  const wrap = document.getElementById('files-table-wrap');
  if (!files.length) {
    wrap.innerHTML = `<div class="empty-state"><div class="es-icon">üì≠</div><h4>Sin archivos a√∫n</h4><p>Usa "Subir archivo" o "Agregar video" para a√±adir materiales.</p></div>`;
    return;
  }
  const rows = files.map(f => {
    const ext = f.name.split('.').pop().toLowerCase();
    const isVideo = f.name.endsWith('.json') && f.name.includes('video_');
    const icon = isVideo ? 'üé¨' : extIcon(ext);
    const cls  = isVideo ? 'ext-vid' : extClass(ext);
    const gpill = groupPill(f._group);
    const title = f.name.replace(/\.[^.]+$/,'').replace(/_/g,' ').replace(/^[a-z\-]+_/i,'');
    const dlUrl = isVideo ? '#' : f.download_url;
    return `<tr>
      <td><div class="file-name-cell">
        <div class="file-ext ${cls}">${icon}</div>
        <div><div class="fn-title">${title}</div><div class="fn-desc">${f.name}</div></div>
      </div></td>
      <td>${gpill}</td>
      <td>${isVideo ? '‚Äî' : (f.size/1024).toFixed(1)+' KB'}</td>
      <td><div class="action-btns">
        <a class="btn-sm btn-view" href="${dlUrl}" target="_blank">üëÅ Ver</a>
        <button class="btn-sm btn-copy" onclick="copyLink('${f.download_url||''}')">üìã Link</button>
        <button class="btn-sm btn-delete" onclick="confirmDelete('${f._group}','${f.name}','${f.sha}')">üóë</button>
      </div></td>
    </tr>`;
  }).join('');
  wrap.innerHTML = `<table class="files-table">
    <thead><tr><th>Archivo</th><th>Grupo</th><th>Tama√±o</th><th>Acciones</th></tr></thead>
    <tbody>${rows}</tbody>
  </table>`;
}

function filterFiles() {
  const q = document.getElementById('search-input').value.toLowerCase();
  const g = document.getElementById('filter-group').value;
  const t = document.getElementById('filter-type').value;
  const filtered = allFiles.filter(f => {
    const ext = f.name.split('.').pop().toLowerCase();
    const isVideo = f.name.startsWith('video_') || ['mp4','mov','avi'].includes(ext);
    const isImg = ['png','jpg','jpeg','gif','webp'].includes(ext);
    const matchQ = !q || f.name.toLowerCase().includes(q);
    const matchG = !g || f._group === g;
    const matchT = !t || (t==='video'&&isVideo)||(t==='img'&&isImg)||(t==='doc'&&!isVideo&&!isImg);
    return matchQ && matchG && matchT;
  });
  renderFilesTable(filtered);
}

function updateStats(files) {
  document.getElementById('stat-total').textContent = files.length;
  document.getElementById('stat-mat').textContent = files.filter(f=>f._group==='matutino').length;
  document.getElementById('stat-ves').textContent = files.filter(f=>f._group==='vespertino').length;
  document.getElementById('stat-sab').textContent = files.filter(f=>f._group==='sabatino').length;
}

function renderRecent(files) {
  const wrap = document.getElementById('recent-files');
  const recent = [...files].reverse().slice(0,6);
  if (!recent.length) { wrap.innerHTML = `<div class="empty-state"><div class="es-icon">üì≠</div><h4>Sin archivos</h4></div>`; return; }
  wrap.innerHTML = recent.map(f => {
    const ext = f.name.split('.').pop().toLowerCase();
    return `<div style="display:flex;align-items:center;gap:10px;padding:0.7rem 0;border-bottom:1px solid rgba(255,255,255,0.04)">
      <div class="file-ext ${extClass(ext)}" style="width:32px;height:32px;border-radius:7px;font-size:1rem">${extIcon(ext)}</div>
      <div style="flex:1"><div style="font-size:0.85rem;font-weight:700">${f.name.replace(/_/g,' ').replace(/\.[^.]+$/,'')}</div><div style="font-size:0.7rem;color:var(--text-dim)">${groupPill(f._group)}</div></div>
      <a style="font-size:0.75rem;color:var(--accent);text-decoration:none" href="${f.download_url||'#'}" target="_blank">Ver ‚Üí</a>
    </div>`;
  }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  UPLOAD ARCHIVOS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let selectedFiles = [];
function handleFiles(fileList) {
  selectedFiles = Array.from(fileList);
  const wrap = document.getElementById('selected-files');
  wrap.innerHTML = selectedFiles.map((f,i) => `
    <div class="sel-file">
      <div class="sf-icon">${extIcon(f.name.split('.').pop().toLowerCase())}</div>
      <div class="sf-info"><div class="sf-name">${f.name}</div><div class="sf-size">${(f.size/1024).toFixed(1)} KB</div></div>
      <button class="sf-remove" onclick="removeFile(${i})">‚úï</button>
    </div>`).join('');
}
function removeFile(i) { selectedFiles.splice(i,1); handleFiles(selectedFiles); }

const dz = document.getElementById('drop-zone');
dz.addEventListener('dragover', e => { e.preventDefault(); dz.classList.add('dragover'); });
dz.addEventListener('dragleave', () => dz.classList.remove('dragover'));
dz.addEventListener('drop', e => { e.preventDefault(); dz.classList.remove('dragover'); handleFiles(e.dataTransfer.files); });

async function uploadFiles() {
  if (!selectedFiles.length) return toast('‚ö†Ô∏è Selecciona al menos un archivo', 'error');
  const c = getConfig();
  const token = GH_TOKEN || localStorage.getItem('cented_token');
  if (!token) return toast('‚ö†Ô∏è Sin token de GitHub. Cierra sesi√≥n y vuelve a ingresar con tu token', 'error');
  const group    = document.getElementById('up-group').value;
  const category = document.getElementById('up-category').value;
  const unit     = document.getElementById('up-unit').value.trim();
  const btn = document.getElementById('btn-upload');
  const txt = document.getElementById('upload-btn-text');
  btn.disabled = true; txt.innerHTML = '<span class="spinner"></span> Subiendo...';
  const pw = document.getElementById('progress-wrap');
  const pb = document.getElementById('progress-bar');
  pw.style.display = 'block';
  let done = 0;
  for (const file of selectedFiles) {
    try {
      const prefix = unit ? unit.replace(/\s+/g,'_')+'_' : '';
      const safeName = `${category}_${prefix}${file.name.replace(/[^a-zA-Z0-9.\-_√°√©√≠√≥√∫√ë√±√º√ú]/g,'_')}`;
      const path = `${c.folder}/${group}/${safeName}`;
      const b64 = await fileToBase64(file);
      let sha;
      try { const cr = await ghReq('GET',`/repos/${c.user}/${c.repo}/contents/${path}`); if(cr.ok){const d=await cr.json();sha=d.sha;} } catch(e){}
      const body = { message:`üìö Subir: ${file.name} [${group}]`, content:b64, branch:c.branch };
      if (sha) body.sha = sha;
      const res = await ghReq('PUT', `/repos/${c.user}/${c.repo}/contents/${path}`, body);
      if (!res.ok) { const err = await res.json(); throw new Error(err.message); }
      done++; pb.style.width = `${(done/selectedFiles.length)*100}%`;
      toast(`‚úÖ Subido: ${file.name}`, 'success');
    } catch(e) { toast(`‚ùå Error: ${e.message}`, 'error'); }
  }
  btn.disabled = false; txt.textContent = '‚¨ÜÔ∏è Subir a GitHub';
  setTimeout(() => { pw.style.display='none'; pb.style.width='0%'; }, 2000);
  selectedFiles = [];
  document.getElementById('selected-files').innerHTML = '';
  document.getElementById('file-input').value = '';
  document.getElementById('up-title').value = '';
  document.getElementById('up-unit').value = '';
  loadFiles();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  VIDEO LINKS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function previewVideo() {
  const url = document.getElementById('vid-url').value.trim();
  const preview = document.getElementById('vid-preview');
  const msg = document.getElementById('vid-preview-msg');
  const iframe = document.getElementById('vid-iframe');
  const embed = getEmbedUrl(url);
  if (embed) {
    iframe.src = embed;
    preview.style.display = 'block';
    msg.style.display = 'none';
  } else {
    preview.style.display = 'none';
    msg.style.display = 'block';
    msg.textContent = url ? 'URL no reconocida. Soporta YouTube y Google Drive.' : 'Ingresa una URL para ver la vista previa.';
  }
}

function getEmbedUrl(url) {
  if (!url) return null;
  // YouTube
  const ytMatch = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/);
  if (ytMatch) return `https://www.youtube.com/embed/${ytMatch[1]}`;
  // YouTube shorts
  const ytShort = url.match(/youtube\.com\/shorts\/([a-zA-Z0-9_-]{11})/);
  if (ytShort) return `https://www.youtube.com/embed/${ytShort[1]}`;
  // Google Drive
  const driveMatch = url.match(/drive\.google\.com\/file\/d\/([^/]+)/);
  if (driveMatch) return `https://drive.google.com/file/d/${driveMatch[1]}/preview`;
  return null;
}

async function saveVideoLink() {
  const c = getConfig();
  const token = GH_TOKEN || localStorage.getItem('cented_token');
  if (!token) return toast('‚ö†Ô∏è Sin token. Cierra sesi√≥n y vuelve a ingresar', 'error');
  const url   = document.getElementById('vid-url').value.trim();
  const title = document.getElementById('vid-title').value.trim();
  const group = document.getElementById('vid-group').value;
  const cat   = document.getElementById('vid-category').value;
  const desc  = document.getElementById('vid-desc').value.trim();
  if (!url || !title) return toast('‚ö†Ô∏è Completa el t√≠tulo y la URL', 'error');
  const embed = getEmbedUrl(url);
  const data = { title, url, embed, group, category:cat, description:desc, type:'video', date:new Date().toISOString() };
  const ts = Date.now();
  const fileName = `video_${cat}_${title.replace(/[^a-zA-Z0-9]/g,'_').slice(0,30)}_${ts}.json`;
  const path = `${c.folder}/${group}/${fileName}`;
  const b64 = btoa(unescape(encodeURIComponent(JSON.stringify(data,null,2))));
  try {
    const res = await ghReq('PUT', `/repos/${c.user}/${c.repo}/contents/${path}`, {
      message: `üé¨ Video: ${title} [${group}]`, content: b64, branch: c.branch
    });
    if (!res.ok) { const err=await res.json(); throw new Error(err.message); }
    toast(`‚úÖ Video guardado: ${title}`, 'success');
    document.getElementById('vid-url').value = '';
    document.getElementById('vid-title').value = '';
    document.getElementById('vid-desc').value = '';
    document.getElementById('vid-preview').style.display = 'none';
    loadFiles();
  } catch(e) { toast(`‚ùå Error: ${e.message}`, 'error'); }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  DELETE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function confirmDelete(group, name, sha) {
  document.getElementById('confirm-msg').textContent = `¬øEliminar "${name.replace(/_/g,' ')}" del grupo ${group}?`;
  document.getElementById('confirm-modal').classList.add('open');
  document.getElementById('confirm-ok').onclick = () => deleteFile(group, name, sha);
}
function closeConfirm() { document.getElementById('confirm-modal').classList.remove('open'); }
async function deleteFile(group, name, sha) {
  closeConfirm();
  const c = getConfig();
  try {
    const res = await ghReq('DELETE', `/repos/${c.user}/${c.repo}/contents/${c.folder}/${group}/${name}`, {
      message:`üóëÔ∏è Eliminar: ${name}`, sha, branch:c.branch
    });
    if (!res.ok) throw new Error((await res.json()).message);
    toast('üóëÔ∏è Eliminado correctamente', 'success');
    loadFiles();
  } catch(e) { toast('‚ùå Error: '+e.message, 'error'); }
}
function copyLink(url) {
  if(!url) return toast('‚ö†Ô∏è Sin link disponible','error');
  navigator.clipboard.writeText(url).then(()=>toast('üìã Link copiado','info'));
}
document.getElementById('confirm-modal').addEventListener('click', e=>{ if(e.target===e.currentTarget) closeConfirm(); });

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  IA PANEL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function loadIA(url, btn) {
  document.querySelectorAll('.ia-tab-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('ia-frame').src = url;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  RUEDA CROM√ÅTICA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let currentHue = 0, currentSat = 1, currentLig = 0.5;
let currentHarmony = 'complementario';
let savedPalette = JSON.parse(localStorage.getItem('cented_palette') || '[]');
let wheelInitialized = false;

function initColorWheel() {
  if (wheelInitialized) return;
  wheelInitialized = true;
  drawWheel();
  const canvas = document.getElementById('colorWheel');
  function pick(e) {
    const rect = canvas.getBoundingClientRect();
    const scaleX = canvas.width/rect.width;
    const scaleY = canvas.height/rect.height;
    const x = ((e.clientX||e.touches[0].clientX)-rect.left)*scaleX - canvas.width/2;
    const y = ((e.clientY||e.touches[0].clientY)-rect.top)*scaleY - canvas.height/2;
    const r = Math.sqrt(x*x+y*y);
    const maxR = canvas.width/2 - 5;
    if (r > maxR) return;
    currentHue = (Math.atan2(y,x)*(180/Math.PI)+360)%360;
    currentSat = Math.min(r/maxR, 1);
    currentLig = parseFloat(document.getElementById('brightness').value)/100;
    updateColorDisplay();
    updateHarmony();
  }
  canvas.addEventListener('mousedown', e=>{ pick(e); canvas.addEventListener('mousemove',pick); });
  canvas.addEventListener('mouseup', ()=>canvas.removeEventListener('mousemove',pick));
  canvas.addEventListener('touchstart', e=>{e.preventDefault();pick(e);},{passive:false});
  canvas.addEventListener('touchmove', e=>{e.preventDefault();pick(e);},{passive:false});
  updateColorDisplay();
  updateHarmony();
  renderSavedPalette();
}

function drawWheel() {
  const canvas = document.getElementById('colorWheel');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const cx = canvas.width/2, cy = canvas.height/2, r = cx-5;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for (let angle=0; angle<360; angle+=0.5) {
    const startAngle = (angle-0.25)*Math.PI/180;
    const endAngle   = (angle+0.5)*Math.PI/180;
    const grad = ctx.createRadialGradient(cx,cy,0,cx,cy,r);
    grad.addColorStop(0, `hsl(${angle},0%,${50*(parseFloat(document.getElementById('brightness').value)/100)*2}%)`);
    grad.addColorStop(1, `hsl(${angle},${document.getElementById('saturation').value}%,${50*(parseFloat(document.getElementById('brightness').value)/100)}%)`);
    ctx.beginPath();
    ctx.moveTo(cx,cy);
    ctx.arc(cx,cy,r,startAngle,endAngle);
    ctx.closePath();
    ctx.fillStyle = grad;
    ctx.fill();
  }
  // overlay para brillo
  const ov = ctx.createRadialGradient(cx,cy,0,cx,cy,r);
  ov.addColorStop(0,'rgba(255,255,255,0.6)');
  ov.addColorStop(1,'rgba(255,255,255,0)');
  ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.fillStyle=ov; ctx.fill();
  // border
  ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2);
  ctx.strokeStyle='rgba(255,255,255,0.1)'; ctx.lineWidth=2; ctx.stroke();
  // cursor
  const bri = parseFloat(document.getElementById('brightness').value)/100;
  const sat = parseFloat(document.getElementById('saturation').value)/100;
  const cr = currentSat * sat * (cx-5);
  const cx2 = cx + cr*Math.cos(currentHue*Math.PI/180);
  const cy2 = cy + cr*Math.sin(currentHue*Math.PI/180);
  ctx.beginPath(); ctx.arc(cx2,cy2,9,0,Math.PI*2);
  ctx.strokeStyle='#fff'; ctx.lineWidth=3; ctx.stroke();
  ctx.beginPath(); ctx.arc(cx2,cy2,6,0,Math.PI*2);
  ctx.fillStyle=hslToHex(currentHue,currentSat*100,bri*50+25); ctx.fill();
  updateColorDisplay();
}

function updateColorDisplay() {
  const bri = parseFloat(document.getElementById('brightness').value)/100;
  const sat = parseFloat(document.getElementById('saturation').value)/100;
  const l = bri*50+25;
  const s = currentSat*100*sat;
  const hex = hslToHex(currentHue, s, l);
  const rgb = hexToRgb(hex);
  const box = document.getElementById('selected-color-box');
  box.style.background = hex;
  const textColor = luminance(rgb.r,rgb.g,rgb.b) > 0.4 ? '#000' : '#fff';
  box.style.color = textColor;
  box.textContent = `${hex.toUpperCase()} ‚Äî Clic para copiar`;
  document.getElementById('hex-val').textContent = hex.toUpperCase();
  document.getElementById('rgb-val').textContent = `rgb(${rgb.r},${rgb.g},${rgb.b})`;
  const h = Math.round(currentHue), sv = Math.round(s), lv = Math.round(l);
  document.getElementById('hsl-val').textContent = `hsl(${h},${sv}%,${lv}%)`;
  const c=parseFloat((1-rgb.r/255).toFixed(2)),m=parseFloat((1-rgb.g/255).toFixed(2)),y=parseFloat((1-rgb.b/255).toFixed(2)),k=parseFloat(Math.min(c,m,y).toFixed(2));
  document.getElementById('cmyk-val').textContent = `C:${Math.round(c*100)} M:${Math.round(m*100)} Y:${Math.round(y*100)} K:${Math.round(k*100)}`;
  // contrast
  const dark = document.getElementById('contrast-box');
  const light = document.getElementById('contrast-box2');
  dark.style.background = hex; dark.style.color = '#000';
  light.style.background = hex; light.style.color = '#fff';
  const lum = luminance(rgb.r,rgb.g,rgb.b);
  const ratioD = (lum+0.05)/(0+0.05);
  const ratioL = (1+0.05)/(lum+0.05);
  dark.textContent  = `Texto oscuro ‚Äî Contraste ${ratioD.toFixed(1)}:1 ${ratioD>=4.5?'‚úÖ AA':'‚ö†Ô∏è bajo'}`;
  light.textContent = `Texto claro ‚Äî Contraste ${ratioL.toFixed(1)}:1 ${ratioL>=4.5?'‚úÖ AA':'‚ö†Ô∏è bajo'}`;
  updateGradients(hex);
}

function updateHarmony() { setHarmony(currentHarmony, null); }

function setHarmony(type, btn) {
  currentHarmony = type;
  if (btn) {
    document.querySelectorAll('.h-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
  }
  const bri = parseFloat(document.getElementById('brightness').value)/100;
  const sat = parseFloat(document.getElementById('saturation').value)/100;
  const l = bri*50+25, s = currentSat*100*sat;
  let hues = [];
  switch(type) {
    case 'complementario': hues=[currentHue,(currentHue+180)%360]; break;
    case 'analogos': hues=[currentHue,(currentHue+30)%360,(currentHue+60)%360,(currentHue-30+360)%360,(currentHue-60+360)%360]; break;
    case 'triadico': hues=[currentHue,(currentHue+120)%360,(currentHue+240)%360]; break;
    case 'tetradico': hues=[currentHue,(currentHue+90)%360,(currentHue+180)%360,(currentHue+270)%360]; break;
    case 'split': hues=[currentHue,(currentHue+150)%360,(currentHue+210)%360]; break;
    case 'monocromatico': hues=[currentHue,currentHue,currentHue,currentHue,currentHue]; break;
  }
  const ligs = type==='monocromatico' ? [80,65,50,35,20] : Array(hues.length).fill(l);
  const sats = type==='monocromatico' ? [s*0.3,s*0.6,s,s*0.8,s*0.5] : Array(hues.length).fill(s);
  const wrap = document.getElementById('harmony-palette');
  wrap.innerHTML = hues.map((h,i) => {
    const hex = hslToHex(h,sats[i],ligs[i]);
    const rgb = hexToRgb(hex);
    const tc = luminance(rgb.r,rgb.g,rgb.b)>0.4?'#000':'#fff';
    return `<div class="swatch-group">
      <div class="swatch" style="background:${hex};border-color:transparent" onclick="selectHarmonyColor('${hex}');copyText('${hex}')" title="${hex}">
        <span style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:0.6rem;font-weight:800;color:${tc};opacity:0;transition:opacity 0.2s" onmouseover="this.style.opacity=1" onmouseout="this.style.opacity=0">Copiar</span>
      </div>
      <div class="swatch-val">${hex.toUpperCase()}</div>
    </div>`;
  }).join('');
}

function selectHarmonyColor(hex) {
  const rgb = hexToRgb(hex);
  const hsl = rgbToHsl(rgb.r,rgb.g,rgb.b);
  currentHue = hsl.h; currentSat = hsl.s/100;
  drawWheel(); updateColorDisplay(); updateHarmony();
}

function updateGradients(hex) {
  const bri = parseFloat(document.getElementById('brightness').value)/100;
  const sat = parseFloat(document.getElementById('saturation').value)/100;
  const l = bri*50+25, s = currentSat*100*sat;
  const hex2 = hslToHex((currentHue+180)%360,s,l);
  const hex3 = hslToHex((currentHue+30)%360,s,l);
  const wrap = document.getElementById('gradient-preview');
  const grads = [
    {name:'Lineal',css:`linear-gradient(135deg,${hex},${hex2})`},
    {name:'An√°logo',css:`linear-gradient(90deg,${hex},${hex3},${hex2})`},
    {name:'Radial',css:`radial-gradient(circle,${hex},${hex2})`},
  ];
  wrap.innerHTML = grads.map(g => {
    const escaped = g.css.replace(/'/g,"\\'");
    return `<div style="height:50px;border-radius:10px;background:${g.css};cursor:pointer;position:relative;overflow:hidden;border:1px solid rgba(255,255,255,0.1)" onclick="copyText('${escaped}')" title="Copiar CSS">
      <span style="position:absolute;right:0.8rem;top:50%;transform:translateY(-50%);font-size:0.72rem;font-weight:800;color:rgba(255,255,255,0.9);text-shadow:0 1px 3px rgba(0,0,0,0.5)">${g.name} ‚Äî clic para copiar</span>
    </div>`;
  }).join('');
}

function addToSaved() {
  const hex = document.getElementById('hex-val').textContent;
  if (savedPalette.length >= 12) return toast('‚ö†Ô∏è M√°ximo 12 colores en la paleta', 'error');
  if (savedPalette.includes(hex)) return toast('‚ö†Ô∏è Este color ya est√° en la paleta', 'info');
  savedPalette.push(hex);
  localStorage.setItem('cented_palette', JSON.stringify(savedPalette));
  renderSavedPalette();
  toast('üé® Color agregado a la paleta', 'success');
}

function renderSavedPalette() {
  const wrap = document.getElementById('saved-swatches');
  if (!savedPalette.length) { wrap.innerHTML = '<p style="font-size:0.78rem;color:var(--text-dim)">Agrega colores con el bot√≥n de abajo</p>'; return; }
  wrap.innerHTML = savedPalette.map((hex,i) => {
    const rgb = hexToRgb(hex); const tc = luminance(rgb.r,rgb.g,rgb.b)>0.4?'#000':'#fff';
    return `<div class="swatch-group">
      <div class="swatch" style="background:${hex}" onclick="copyText('${hex}')" title="${hex}">
        <button style="position:absolute;top:-4px;right:-4px;width:16px;height:16px;border-radius:50%;background:var(--danger);border:none;color:#fff;font-size:0.6rem;cursor:pointer;display:flex;align-items:center;justify-content:center" onclick="event.stopPropagation();removeSaved(${i})">‚úï</button>
      </div>
      <div class="swatch-val">${hex}</div>
    </div>`;
  }).join('');
}

function removeSaved(i) { savedPalette.splice(i,1); localStorage.setItem('cented_palette',JSON.stringify(savedPalette)); renderSavedPalette(); }
function clearSaved() { savedPalette=[]; localStorage.setItem('cented_palette','[]'); renderSavedPalette(); toast('üóëÔ∏è Paleta limpiada','info'); }
function exportPalette() {
  if (!savedPalette.length) return toast('‚ö†Ô∏è Agrega colores primero','error');
  const css = `:root {\n${savedPalette.map((h,i)=>`  --color-${i+1}: ${h};`).join('\n')}\n}`;
  navigator.clipboard.writeText(css).then(()=>toast('üìã CSS de paleta copiado','success'));
}
function copyHex() { copyText(document.getElementById('hex-val').textContent); }
function copyText(text) {
  navigator.clipboard.writeText(text).then(()=>toast(`üìã Copiado: ${text}`,'info')).catch(()=>{
    const ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); toast(`üìã Copiado: ${text}`,'info');
  });
}

// ‚îÄ‚îÄ Color math helpers ‚îÄ‚îÄ
function hslToHex(h,s,l) {
  s/=100; l/=100;
  const a=s*Math.min(l,1-l);
  const f=n=>{const k=(n+h/30)%12;return l-a*Math.max(Math.min(k-3,9-k,1),-1)};
  return '#'+[f(0),f(8),f(4)].map(x=>{const hex=Math.round(x*255).toString(16);return hex.length===1?'0'+hex:hex}).join('');
}
function hexToRgb(hex) {
  const r=parseInt(hex.slice(1,3),16),g=parseInt(hex.slice(3,5),16),b=parseInt(hex.slice(5,7),16);
  return {r,g,b};
}
function rgbToHsl(r,g,b) {
  r/=255;g/=255;b/=255;
  const max=Math.max(r,g,b),min=Math.min(r,g,b);let h,s,l=(max+min)/2;
  if(max===min){h=s=0}else{const d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);
    switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}h/=6}
  return {h:h*360,s:s*100,l:l*100};
}
function luminance(r,g,b) {
  const toL=c=>{c/=255;return c<=0.04045?c/12.92:Math.pow((c+0.055)/1.055,2.4)};
  return 0.2126*toL(r)+0.7152*toL(g)+0.0722*toL(b);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  UTILS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function fileToBase64(file) {
  return new Promise((res,rej)=>{
    const r=new FileReader();
    r.onload=()=>res(r.result.split(',')[1]);
    r.onerror=rej; r.readAsDataURL(file);
  });
}
function extIcon(ext) {
  const m={pdf:'üìÑ',doc:'üìù',docx:'üìù',ppt:'üìä',pptx:'üìä',xls:'üìà',xlsx:'üìà',zip:'üì¶',rar:'üì¶',png:'üñºÔ∏è',jpg:'üñºÔ∏è',jpeg:'üñºÔ∏è',mp4:'üé¨',mov:'üé¨',avi:'üé¨',txt:'üìÉ',json:'üîó'};
  return m[ext]||'üìé';
}
function extClass(ext) {
  if(ext==='pdf')return 'ext-pdf';
  if(['doc','docx'].includes(ext))return 'ext-doc';
  if(['ppt','pptx'].includes(ext))return 'ext-ppt';
  if(['zip','rar'].includes(ext))return 'ext-zip';
  if(['mp4','mov','avi'].includes(ext))return 'ext-vid';
  if(['png','jpg','jpeg','gif'].includes(ext))return 'ext-img';
  if(['json'].includes(ext))return 'ext-vid';
  return 'ext-other';
}
function groupPill(g) {
  const m={matutino:'<span class="group-pill pill-m">üåÖ Matutino</span>',vespertino:'<span class="group-pill pill-v">üåá Vespertino</span>',sabatino:'<span class="group-pill pill-s">üìö Sabatino</span>',todos:'<span class="group-pill pill-all">üåê Todos</span>'};
  return m[g]||g;
}
function toast(msg, type='info') {
  const el=document.createElement('div');
  el.className=`toast ${type}`; el.textContent=msg;
  document.getElementById('toasts').appendChild(el);
  setTimeout(()=>{el.style.animation='slideOut 0.3s ease forwards';setTimeout(()=>el.remove(),300);},3500);
}

// Restore token on load
window.addEventListener('load',()=>{
  const saved=localStorage.getItem('cented_token');
  if(saved) document.getElementById('login-token').value=saved;
  GH_TOKEN=saved||'';
});
</script>
</body>
</html>
